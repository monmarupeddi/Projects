---
title: "Project 6"
author: "Lakshmi Mounica Marupeddi"
date: "2024-07-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(nycflights13)
```

### Question 1
Create a new column in the flights set called "total_delay". Select only the month, carrier, origin, dest, distance, total_delay, arr_delay columns. Save this to a new dataset called fl_new. You can use the code given below. Which of the following carriers has the smallest mean total delay in the fl_new data?
```{r}
fl_new = flights %>% mutate(total_delay = dep_delay+arr_delay) %>% select(month, carrier, origin, dest, distance,total_delay,  arr_delay) 
fl_new %>% group_by(carrier) %>% summarize(smallestmean = mean(total_delay, na.rm = TRUE)) %>% arrange(smallestmean) 


```

### Question 2
What are the key or common variables in the fl_new and airports datasets that you can use to join? A common variable means the values of the variables are the same, and as such can be used to join two datasets. The names of the variables may be different in the 2 sets. There can be more than one column that are common in both datasets. Hint: The common columns are the ones regarding the airport code. There are 3 right choices.
```{r}
fl_new
```



### Question 3
Join the "fl_new" and the "airports" data using the code given below and save it to "fl_airport". If done correctly the first few rows should look like the table given in the image. From now on use "fl_airport" data to answer the questions. How many flights are there to "Tampa Intl" airport in June?
```{r}
fl_airport = inner_join(fl_new, airports, by = c('dest'= 'faa'))
head(fl_airport)
fl_airport %>% filter(month==6 & name == "Tampa Intl") %>% count()
```



### Question 4
Which month experienced the largest average total_delay in the fl_airport data?
```{r}
fl_airport %>% group_by(month) %>% summarize(means = mean(total_delay, na.rm = TRUE))  %>% arrange(-means)
```


### Question 5
Continue working on fl_airport data. What is the average arr_delay in flights to "Tampa Intl" airport in September?
```{r}
fl_airport %>% filter(month==9 & name == "Tampa Intl") %>% summarize(mean(arr_delay, na.rm=TRUE))
```


### Question 6
Continue working on fl_airport data. What is the mean "distance" in flights to "Chicago Ohare Intl" airport in July? Choose the closest value.
```{r}
fl_airport %>% filter(month==7 & name == "Chicago Ohare Intl") %>% summarize(mean(distance, na.rm=TRUE))
```


### Question 7
Continue working on fl_airport data. Which one of the following is the airport with largest average arr_delay?
```{r}
fl_airport %>% group_by(name) %>% summarize(means = mean(arr_delay, na.rm = TRUE)) %>% arrange(-means)
```


### Question 8
Continue working on fl_airport data. Which one of the following is the airport that has the largest average arr_delay that had at least 10,000 arrivals? Hint: First get the airports with at least 10,000 arrivals. Then check the mean arrival delay among those airports.
```{r}
temp = fl_airport %>% group_by(name) %>% summarize(n=n()) %>% filter(n >= 10000)
t = inner_join(fl_airport, temp, by = c("name" = "name"))
t %>% group_by(name) %>% summarize(means = mean(arr_delay, na.rm = TRUE)) %>% arrange(-means)
```


### Question 9
Continue using fl_airport data. Plot a histogram of the distance variable with default settings. Approximately what is the most common distance flown?
```{r}
fl_airport %>% summarize(mean(distance, na.rm = TRUE))
fl_airport %>% ggplot(aes(x=distance)) + geom_histogram()
```


### Question 10
Continue using fl_airport data. Plot a scatter chart using ggplot of arrival delay vs distance. The plotting will take some time and should look like the following. What can we conclude from the plot? If you try to plot using all the data points, it will be very slow - so you should first sample points from the data. The plot is given below. (3 correct choices)
```{r}
fl_airport %>% ggplot(aes(x=distance, y=arr_delay)) + geom_point()
```


### Question 11
Continue using fl_airport data. Filter the carrier UA and create a histogram using 100 bins. What can we say based on the histogram?
```{r}
fl_airport %>% filter(carrier=="UA") %>% ggplot(aes(x=arr_delay)) + geom_histogram(bins = 100)
```


### Question 12
Now go back to flights dataset. Create a scatter plot of dep_delay vs arr_delay using carrier UA's data only. Which of the following statements are correct? (More than one are possible)
```{r}
tempj = flights %>% filter(carrier=="UA") 
tempj %>% ggplot(aes(x=arr_delay, y=dep_delay)) + geom_point()
cor(tempj$arr_time, tempj$dep_delay, use = "complete.obs")
```

